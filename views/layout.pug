doctype html
html(lang="en")
  head
    -
      var seoData = seo || {};
      var pageTitle = seoData.title || title || 'At-Taqwa Foundation';
      var pageDescription = seoData.description || 'At-Taqwa Foundation: live teachings, Islamic Q&A, videos, and articles.';
      var pageCanonicalUrl = seoData.canonical || canonicalUrl || currentUrl || '';
      var ogType = seoData.ogType || 'website';
      var robotsValue = seoData.robots || 'index,follow';
      var twitterCard = seoData.twitterCard || 'summary_large_image';
      var siteName = seoData.siteName || 'At-Taqwa Foundation';
      var rawImage = seoData.image || '/images/attaqwa.jpg';
      var imageUrl = rawImage && rawImage.charAt(0) === '/' && siteUrl ? (siteUrl + rawImage) : rawImage;
      var ldItems = Array.isArray(seoData.jsonLd) ? seoData.jsonLd : [];
    meta(charset="utf-8")
    meta(name="viewport" content="width=device-width, initial-scale=1")
    title= pageTitle
    meta(name="description" content=pageDescription)
    meta(name="robots" content=robotsValue)
    if pageCanonicalUrl
      link(rel="canonical" href=pageCanonicalUrl)

    meta(property="og:title" content=pageTitle)
    meta(property="og:description" content=pageDescription)
    meta(property="og:type" content=ogType)
    meta(property="og:site_name" content=siteName)
    if pageCanonicalUrl
      meta(property="og:url" content=pageCanonicalUrl)
    if imageUrl
      meta(property="og:image" content=imageUrl)

    meta(name="twitter:card" content=twitterCard)
    meta(name="twitter:title" content=pageTitle)
    meta(name="twitter:description" content=pageDescription)
    if imageUrl
      meta(name="twitter:image" content=imageUrl)

    link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css")
    link(rel="stylesheet", href="/stylesheets/layout.css")
    link(
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    )
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" rel="stylesheet">
    link(rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png")
    link(rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png")
    link(rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png")
    link(rel="manifest" href="/site.webmanifest")
    each ld in ldItems
      script(type="application/ld+json")!= JSON.stringify(ld)


  body.site-body
    // Navbar Section
    nav.navbar.navbar-expand-lg.site-navbar
      .container
        // Logo
        a.navbar-brand.site-brand(href="/")
          img.navbar-logo(src="/images/attaqwa.jpg" alt="At-Taqwa Foundation logo")
          span.brand-title At-Taqwa Foundation

        // Navbar Toggle for Small Screens
        button.navbar-toggler.site-toggler(
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        )
          span.navbar-toggler-icon

        // Navbar Links
        .collapse.navbar-collapse#navbarSupportedContent
          ul.navbar-nav.me-auto.mb-2.mb-lg-0
            li.nav-item
              a.nav-link.active(aria-current="page" href="/") Home
            if isLoggedIn && admin
              li.nav-item
                a.nav-link(href="/dashboard") Dashboard
            li.nav-item
              a.nav-link(href="/donate") Donate
            li.nav-item
              a.nav-link(href="mailto:attaqwafoundationhum@gmail.com") Contact Us

          form.d-flex.site-search(method="get" action="/search")
            input.form-control(name="q" type="search" placeholder="Search topics" aria-label="Search" required)
            button.btn.btn-search(type="submit") Search

          // Username and Messages Section
          .d-flex.align-items-center.site-user-actions
            if isLoggedIn && admin
              // Admin Username
              span.site-user-name= admin.username ? admin.username[0].toUpperCase() + admin.username.slice(1).toLowerCase() : ''
              // Admin Dropdown Menu
              .dropdown
                a.nav-link.dropdown-toggle.user-menu-toggle(href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false")
                  i(class="fas fa-user-circle")
                ul.dropdown-menu.dropdown-menu-end
                  li
                    a.dropdown-item(href="/admin/settings/password") Settings
                  li
                    hr.dropdown-divider
                  li
                    a.dropdown-item(href="/signout") Sign Out
            else if isLoggedIn && user
              // User Messages Dropdown
              .dropdown
                a.nav-link.dropdown-toggle.messages-link(href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Messages")
                  i(class="fas fa-envelope")
                  if unreadMessages > 0
                    span.badge.bg-danger= unreadMessages
                ul.dropdown-menu.dropdown-menu-end.messages-dropdown
                  if navMessages && navMessages.length
                    each navMessage in navMessages
                      li
                        a.dropdown-item.messages-dropdown-item(
                          href=`/messages/${navMessage.id}/open`
                          class=(navMessage.isRead ? '' : 'is-unread')
                        )
                          span.messages-dropdown-title= navMessage.subject
                          span.messages-dropdown-preview= navMessage.preview
                          small.messages-dropdown-time= navMessage.createdAt ? new Date(navMessage.createdAt).toLocaleString() : ''
                    li
                      hr.dropdown-divider
                    li
                      a.dropdown-item.text-center.fw-semibold(href="/user_messages") View all messages
                  else
                    li
                      span.dropdown-item-text.text-muted No messages yet.
              a.nav-link(href="/my_class_sessions") Class
              // User Username
              span.site-user-name= user.username ? user.username[0].toUpperCase() + user.username.slice(1).toLowerCase() : ''
              .dropdown
                a.nav-link.dropdown-toggle.user-menu-toggle(href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false")
                  i(class="fas fa-user-circle")
                ul.dropdown-menu.dropdown-menu-end
                  li
                    a.dropdown-item(href="/my_class_sessions") My Class Sessions
                  li
                    a.dropdown-item(href="/register") Register Session
                  li
                    a.dropdown-item(href="/settings/password") Settings
                  li
                    hr.dropdown-divider
                  li
                    a.dropdown-item(href="/signout") Sign Out
            else
              // Sign In and Sign Up Links
              a.nav-link.auth-link(href="/signin") Sign In

    // Body Section
    main.site-main
      .container
        block content
        block scripts

    // Footer Section
    footer.site-footer
      .container
        p.mb-2 &copy; 2024 At-Taqwa Foundation. All Rights Reserved.
        .social-media-icons
          a(href="https://www.facebook.com/TaqwaAnd?mibextid=ZbWKwL" target="_blank") Facebook
          a(href="https://x.com/TaqwaAnd?s=09" target="_blank") Twitter
          a(href="https://www.instagram.com" target="_blank") Instagram
          a(href="https://www.youtube.com/@at-taqwafoundationandhuman2761" target="_blank") YouTube
        p.mt-2.mb-2
          a(href="#") Privacy Policy
          span.mx-2 |
          a(href="#") Terms of Service
        p.mb-0
          | Support us:
          a.ms-2(href="/donate") Donate to At-Taqwa Foundation

    script(src="/javascripts/userSignUp.js")
    script(
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    )
    script(src="/javascripts/buttonLoading.js")
